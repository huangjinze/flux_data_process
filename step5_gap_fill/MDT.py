import pandas as pd
import numpy as np

class MDT:
    def mdt_method(self, data, condition, value, mdt_interval=384):
        # print(data.head(70))
        #白天的数据重新设置索引，然后找出相应nan的数据
        temp_data = data[condition].set_index([list(range(len(data[condition])))])

        #筛选的条件
        Condition = (temp_data[value].isnull().values==True)
        # 缺失值的索引
        var_index = temp_data[Condition].index.tolist()
        # print(var_index)
        # print(len(var_index))

        for i in var_index:
            #在temp_data和data 相同时间条件
            condition = (data['date_time'] == temp_data.loc[i]['date_time'])
            data.loc[data[condition].index, value] = calculate_mean(temp_data, i, value, mdt_interval)
        return data

def calculate_mean(data, i_index, value, mdt_interval):
    if i_index - mdt_interval <= 0:
        start_index = 0
        end_index = i_index + mdt_interval
    if i_index - mdt_interval >= 0 and i_index + mdt_interval <= len(data):
        start_index = i_index - mdt_interval
        end_index = i_index + mdt_interval
    if i_index + mdt_interval > len(data):
        start_index = i_index - mdt_interval
        end_index = len(data)
    temp = data[start_index: end_index + 1]
    times = pd.DatetimeIndex(temp['date_time'])

    res = temp.groupby([times.hour, times.minute])[value].mean()
    return res[temp.loc[i_index]['date_time'].hour][temp.loc[i_index]['date_time'].minute]


# 性能太低了
# def calculate_mean(data, i_index, value, interval):
#     if i_index - interval <= 0:
#         start_index = 0
#         end_index = i_index + interval
#     if i_index - interval >= 0 and i_index + interval <= len(data):
#         start_index = i_index - interval
#         end_index = i_index + interval
#     if i_index + interval > len(data):
#         start_index = i_index - interval
#         end_index = len(data)
#     temp = data[start_index: end_index+1]
#     key1 = lambda x: temp.loc[x]['date_time'].hour
#     key2 = lambda x: temp.loc[x]['date_time'].minute
#     res = temp.groupby([key1, key2])[value].mean()
#
#     return res[temp.loc[i_index]['date_time'].hour][temp.loc[i_index]['date_time'].minute]




if __name__ == '__main__':
    var_index= \
        [21, 40, 60, 80, 81, 82, 83, 100, 140, 160, 161, 260, 261, 262, 280, 281, 339, 340, 360, 361, 420, 421, 523,
         542, 543, 648, 649, 650, 651, 669, 670, 711, 712, 754, 776, 777, 797, 798, 799, 818, 819, 840, 906, 950, 951,
         972, 994, 1016, 1017, 1038, 1039, 1060, 1170, 1171, 1172, 1193, 1238, 1239, 1378, 1379, 1380, 1381, 1402, 1450,
         1474, 1475, 1570, 1691, 1692, 1714, 1715, 1887, 1888, 1889, 2067, 2145, 2170, 2197, 2408, 2409, 2841, 2868,
         2895, 2896, 2897, 2898, 2916, 2917, 2918, 2919, 2920, 2921, 2922, 2923, 2924, 2925, 2926, 2927, 2928, 2929,
         2930, 2931, 2932, 2933, 2934, 2935, 2936, 2937, 2938, 2939, 2940, 2941, 2942, 2943, 2944, 2945, 2946, 2947,
         2948, 2949, 2950, 2951, 2952, 2953, 2954, 2955, 2956, 2957, 2958, 2959, 2960, 2961, 2962, 2963, 2964, 2965,
         2966, 2967, 2968, 2969, 2970, 2971, 2972, 2973, 2974, 2975, 2976, 2977, 2978, 2979, 2980, 2981, 2982, 2983,
         2984, 2985, 2986, 2987, 2988, 2989, 2990, 2991, 2992, 2993, 2994, 2995, 2996, 2997, 2998, 2999, 3000, 3001,
         3002, 3003, 3004, 3005, 3006, 3007, 3008, 3009, 3010, 3011, 3012, 3013, 3014, 3015, 3016, 3017, 3018, 3019,
         3020, 3021, 3022, 3023, 3024, 3025, 3026, 3027, 3028, 3029, 3030, 3031, 3032, 3033, 3034, 3035, 3036, 3037,
         3038, 3039, 3040, 3041, 3042, 3043, 3044, 3045, 3046, 3047, 3048, 3049, 3050, 3051, 3052, 3053, 3054, 3055,
         3056, 3057, 3058, 3059, 3060, 3061, 3062, 3063, 3064, 3065, 3066, 3067, 3068, 3069, 3070, 3071, 3072, 3073,
         3074, 3075, 3076, 3077, 3078, 3079, 3080, 3081, 3082, 3083, 3084, 3085, 3086, 3087, 3088, 3089, 3090, 3091,
         3092, 3093, 3094, 3095, 3096, 3097, 3098, 3099, 3100, 3101, 3102, 3103, 3104, 3105, 3106, 3107, 3108, 3109,
         3110, 3111, 3112, 3113, 3114, 3115, 3116, 3117, 3118, 3119, 3120, 3121, 3122, 3123, 3124, 3125, 3126, 3127,
         3128, 3129, 3130, 3131, 3132, 3133, 3134, 3135, 3136, 3137, 3138, 3139, 3140, 3141, 3142, 3143, 3144, 3145,
         3146, 3147, 3148, 3149, 3150, 3151, 3185, 3417, 3444, 3445, 3446, 3447, 3448, 3449, 3450, 3473, 3501, 3762,
         3763, 3791, 3792, 3911, 3941, 4000, 4061, 4062, 4300, 4507, 4536, 4538, 4567, 4745, 4746, 4747, 4748, 4749,
         4750, 4751, 4752, 4775, 4776, 4777, 4804, 4805, 4835, 4866, 4867, 4896, 4897, 4898, 4926, 4955, 5075, 5193,
         5194, 5195, 5196, 5197, 5366, 5452, 5453, 5454, 5802, 5809, 5810, 5811, 5841, 5921, 5922, 5978, 6141, 6220,
         6221, 6325, 6352, 6377, 6378, 6482, 6483, 6484, 6485, 6584, 6709, 6733, 6734, 6735, 6736, 6834, 6835, 6860,
         6861, 6956, 6981, 7006, 7007, 7031, 7104, 7105, 7151, 7152, 7222, 7337, 7338, 7451, 7452, 7453, 7454, 7455,
         7473, 7474, 7497, 7498, 7651, 7673, 7674, 7717, 7783, 7827, 7849, 7893, 7978, 7979, 8041, 8103, 8104, 8145,
         8165, 8189, 8190, 8524, 8525, 8526, 8527, 8528, 8544, 8582, 8583, 8601, 8602, 8622, 8623, 8624, 8625, 8626,
         8627, 8628, 8629, 8630, 8631, 8632, 8633, 8634, 8635, 8636, 8637, 8640, 8734, 8735, 8736, 8737, 8738, 8739,
         8740, 8741, 8742, 8743, 8744, 8745, 8746, 8747, 8810, 8850, 8889, 8890]
    day = \
        [66, 113, 161, 209, 210, 211, 212, 257, 353, 401, 402, 641, 642, 643, 689, 690, 804, 833, 881, 882, 1025, 1026,
         1266, 1285, 1313, 1553, 1554, 1555, 1556, 1601, 1602, 1697, 1698, 1792, 1841, 1842, 1889, 1890, 1891, 1936,
         1937, 1984, 2128, 2224, 2225, 2272, 2320, 2368, 2369, 2416, 2417, 2464, 2704, 2705, 2706, 2752, 2848, 2849,
         3135, 3136, 3137, 3138, 3183, 3279, 3327, 3328, 3519, 3760, 3761, 3807, 3808, 4142, 4143, 4144, 4478, 4622,
         4647, 4718, 5101, 5102, 5869, 5917, 5964, 5965, 5966, 5967, 5985, 5986, 5987, 5988, 5989, 5990, 5991, 5992,
         6012, 6013, 6014, 6015, 6016, 6017, 6018, 6019, 6020, 6021, 6022, 6023, 6024, 6025, 6026, 6027, 6028, 6029,
         6030, 6031, 6032, 6033, 6034, 6035, 6036, 6037, 6038, 6039, 6040, 6060, 6061, 6062, 6063, 6064, 6065, 6066,
         6067, 6068, 6069, 6070, 6071, 6072, 6073, 6074, 6075, 6076, 6077, 6078, 6079, 6080, 6081, 6082, 6083, 6084,
         6085, 6086, 6087, 6088, 6108, 6109, 6110, 6111, 6112, 6113, 6114, 6115, 6116, 6117, 6118, 6119, 6120, 6121,
         6122, 6123, 6124, 6125, 6126, 6127, 6128, 6129, 6130, 6131, 6132, 6133, 6134, 6135, 6136, 6156, 6157, 6158,
         6159, 6160, 6161, 6162, 6163, 6164, 6165, 6166, 6167, 6168, 6169, 6170, 6171, 6172, 6173, 6174, 6175, 6176,
         6177, 6178, 6179, 6180, 6181, 6182, 6183, 6184, 6204, 6205, 6206, 6207, 6208, 6209, 6210, 6211, 6212, 6213,
         6214, 6215, 6216, 6217, 6218, 6219, 6220, 6221, 6222, 6223, 6224, 6225, 6226, 6227, 6228, 6229, 6230, 6231,
         6232, 6252, 6253, 6254, 6255, 6256, 6257, 6258, 6259, 6260, 6261, 6262, 6263, 6264, 6265, 6266, 6267, 6268,
         6269, 6270, 6271, 6272, 6273, 6274, 6275, 6276, 6277, 6278, 6279, 6280, 6300, 6301, 6302, 6303, 6304, 6305,
         6306, 6307, 6308, 6309, 6310, 6311, 6312, 6313, 6314, 6315, 6316, 6317, 6318, 6319, 6320, 6321, 6322, 6323,
         6324, 6325, 6326, 6327, 6328, 6348, 6349, 6350, 6351, 6352, 6353, 6354, 6355, 6356, 6357, 6358, 6359, 6360,
         6361, 6362, 6363, 6364, 6365, 6366, 6367, 6368, 6369, 6370, 6371, 6372, 6444, 6830, 6876, 6877, 6878, 6879,
         6880, 6881, 6882, 6924, 6952, 7404, 7405, 7452, 7453, 7740, 7788, 7865, 7980, 7981, 8364, 8700, 8729, 8749,
         8796, 9065, 9084, 9085, 9086, 9087, 9088, 9089, 9090, 9113, 9132, 9133, 9160, 9161, 9209, 9276, 9277, 9324,
         9325, 9326, 9372, 9401, 9612, 9804, 9805, 9806, 9807, 9808, 10092, 10237, 10238, 10239, 10829, 10836, 10837,
         10838, 10909, 11031, 11032, 11149, 11437, 11558, 11559, 11773, 11821, 11846, 11847, 12062, 12063, 12064, 12065,
         12254, 12494, 12518, 12542, 12543, 12544, 12734, 12735, 12783, 12784, 12974, 13022, 13070, 13071, 13118, 13262,
         13263, 13358, 13359, 13503, 13743, 13744, 13983, 13984, 13985, 13986, 13987, 14005, 14031, 14079, 14080, 14415,
         14463, 14464, 14559, 14703, 14799, 14847, 14944, 15136, 15137, 15280, 15424, 15425, 15520, 15568, 15620, 15621,
         16432, 16433, 16434, 16435, 16436, 16481, 16577, 16578, 16625, 16626, 16675, 16676, 16677, 16678, 16679, 16680,
         16681, 16682, 16683, 16684, 16685, 16686, 16687, 16688, 16689, 16690, 16722, 16961, 16962, 16963, 16964, 16965,
         16966, 16967, 16968, 16969, 16970, 16971, 16972, 16973, 16974, 17153, 17249, 17345, 17346]

    night = \
        [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 59, 60, 86, 87, 88, 89, 90, 91, 92, 93, 94, 100, 101,
         102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143,
         144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 159, 160, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191,
         192, 193, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239,
         240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 283, 284, 285, 286, 287,
         326, 327, 328, 329, 335, 336, 337, 338, 344, 345, 346, 347, 348, 349, 350, 351, 352, 375, 376, 377, 378, 379,
         380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 421,
         422, 423, 447, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488,
         494, 495, 566, 567, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590,
         613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634,
         635, 636, 637, 638, 639, 640, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679,
         680, 681, 682, 683, 684, 685, 686, 687, 688, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 805, 806, 807,
         808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829,
         830, 831, 832, 854, 855, 856, 857, 858, 872, 873, 874, 875, 876, 877, 878, 879, 880, 951, 998, 999, 1000, 1001,
         1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1024,
         1046, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1110, 1111, 1112, 1113, 1114, 1115,
         1116, 1117, 1118, 1119, 1120, 1190, 1191, 1192, 1193, 1194, 1205, 1206, 1240, 1286, 1287, 1288, 1304, 1305,
         1306, 1307, 1308, 1309, 1310, 1311, 1312, 1334, 1335, 1336, 1337, 1338, 1339, 1340, 1341, 1342, 1343, 1344,
         1345, 1346, 1347, 1348, 1349, 1350, 1351, 1352, 1353, 1354, 1382, 1383, 1384, 1385, 1386, 1387, 1388, 1389,
         1390, 1482, 1483, 1484, 1485, 1486, 1487, 1488, 1489, 1495, 1496, 1497, 1498, 1499, 1500, 1501, 1502, 1503,
         1504, 1534, 1535, 1536, 1537, 1538, 1539, 1540, 1541, 1542, 1543, 1544, 1545, 1546, 1547, 1548, 1549, 1550,
         1551, 1552, 1575, 1576, 1577, 1578, 1579, 1580, 1581, 1582, 1583, 1584, 1585, 1586, 1587, 1588, 1589, 1590,
         1598, 1599, 1600, 1629, 1630, 1631, 1632, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1643,
         1644, 1645, 1646, 1722, 1723, 1724, 1768, 1769, 1770, 1771, 1772, 1773, 1774, 1775, 1776, 1777, 1778, 1779,
         1780, 1781, 1782, 1783, 1784, 1785, 1786, 1787, 1788, 1789, 1790, 1791, 1816, 1817, 1818, 1819, 1825, 1826,
         1827, 1828, 1829, 1830, 1831, 1837, 1838, 1839, 1840, 1863, 1864, 1865, 1866, 1867, 1868, 1869, 1870, 1871,
         1872, 1873, 1874, 1875, 1876, 1877, 1878, 1879, 1880, 1881, 1882, 1883, 1884, 1885, 1886, 1887, 1888, 1911,
         1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920, 1921, 1922, 1923, 1924, 1925, 1926, 1927, 1928, 1929,
         1930, 1931, 1932, 1933, 1934, 1935, 1974, 1975, 1976, 1977, 1978, 2016, 2017, 2018, 2019, 2020, 2021, 2022,
         2104, 2105, 2106, 2107, 2108, 2114, 2115, 2116, 2117, 2118, 2119, 2120, 2121, 2122, 2123, 2124, 2125, 2126,
         2127, 2155, 2156, 2157, 2158, 2159, 2160, 2161, 2162, 2163, 2164, 2165, 2166, 2167, 2168, 2169, 2170, 2171,
         2172, 2173, 2202, 2203, 2204, 2205, 2206, 2207, 2208, 2209, 2210, 2211, 2212, 2213, 2214, 2215, 2216, 2217,
         2218, 2219, 2220, 2221, 2222, 2223, 2248, 2249, 2250, 2251, 2252, 2253, 2254, 2255, 2256, 2262, 2263, 2264,
         2265, 2266, 2267, 2268, 2269, 2270, 2271, 2294, 2295, 2296, 2297, 2298, 2299, 2300, 2301, 2302, 2303, 2304,
         2305, 2306, 2307, 2308, 2309, 2310, 2311, 2312, 2313, 2314, 2315, 2316, 2317, 2318, 2319, 2344, 2345, 2346,
         2347, 2348, 2349, 2350, 2351, 2352, 2353, 2354, 2355, 2356, 2357, 2358, 2359, 2360, 2361, 2362, 2363, 2364,
         2365, 2366, 2367, 2399, 2400, 2401, 2408, 2409, 2410, 2411, 2412, 2413, 2414, 2415, 2439, 2440, 2441, 2442,
         2443, 2444, 2445, 2446, 2447, 2448, 2449, 2450, 2451, 2452, 2453, 2454, 2455, 2456, 2457, 2458, 2459, 2460,
         2461, 2462, 2463, 2678, 2679, 2680, 2681, 2682, 2683, 2684, 2685, 2686, 2687, 2688, 2689, 2690, 2691, 2692,
         2693, 2694, 2695, 2696, 2697, 2698, 2699, 2700, 2701, 2702, 2703, 2728, 2729, 2730, 2731, 2732, 2733, 2734,
         2735, 2736, 2737, 2738, 2739, 2740, 2741, 2742, 2743, 2744, 2745, 2746, 2747, 2748, 2749, 2750, 2751, 2798,
         2799, 2830, 2831, 2832, 2833, 2834, 2835, 2841, 2842, 2843, 2844, 2845, 2846, 2847, 2877, 2878, 2879, 2880,
         2881, 2894, 2895, 3115, 3116, 3117, 3118, 3119, 3120, 3121, 3122, 3123, 3124, 3125, 3126, 3127, 3128, 3129,
         3130, 3131, 3132, 3133, 3134, 3163, 3164, 3165, 3166, 3167, 3168, 3169, 3170, 3171, 3172, 3173, 3174, 3175,
         3176, 3177, 3178, 3179, 3180, 3181, 3182, 3258, 3264, 3265, 3266, 3267, 3268, 3313, 3314, 3315, 3316, 3317,
         3318, 3319, 3320, 3321, 3322, 3323, 3324, 3325, 3326, 3371, 3372, 3373, 3374, 3410, 3411, 3412, 3413, 3414,
         3415, 3416, 3417, 3418, 3419, 3420, 3421, 3422, 3449, 3450, 3451, 3452, 3453, 3454, 3455, 3456, 3457, 3458,
         3459, 3460, 3461, 3462, 3463, 3464, 3465, 3466, 3467, 3499, 3500, 3501, 3502, 3503, 3504, 3505, 3506, 3512,
         3518, 3555, 3556, 3557, 3601, 3602, 3603, 3604, 3605, 3606, 3607, 3641, 3701, 3702, 3703, 3704, 3743, 3744,
         3745, 3746, 3747, 3748, 3749, 3750, 3751, 3752, 3753, 3754, 3789, 3790, 3791, 3792, 3793, 3794, 3795, 3796,
         3797, 3798, 3799, 3800, 3801, 3802, 3803, 3804, 3805, 3806, 3977, 3978, 4025, 4026, 4027, 4028, 4074, 4075,
         4076, 4077, 4078, 4087, 4088, 4089, 4090, 4129, 4130, 4131, 4132, 4133, 4134, 4135, 4136, 4137, 4138, 4139,
         4140, 4141, 4179, 4180, 4181, 4182, 4183, 4184, 4185, 4186, 4187, 4188, 4281, 4282, 4283, 4284, 4285, 4413,
         4464, 4465, 4466, 4467, 4468, 4469, 4470, 4471, 4472, 4473, 4474, 4475, 4476, 4477, 4508, 4509, 4510, 4511,
         4512, 4513, 4514, 4515, 4555, 4556, 4572, 4573, 4604, 4605, 4606, 4607, 4608, 4609, 4610, 4611, 4612, 4613,
         4614, 4615, 4616, 4617, 4618, 4619, 4620, 4621, 4648, 4649, 4650, 4703, 4704, 4705, 4706, 4707, 4708, 4709,
         4710, 4711, 4712, 4713, 4714, 4715, 4716, 4717, 4807, 4808, 4809, 4810, 4811, 4812, 4937, 4938, 4984, 4985,
         4986, 5034, 5035, 5036, 5037, 5038, 5039, 5040, 5041, 5082, 5083, 5084, 5085, 5086, 5087, 5088, 5089, 5090,
         5091, 5092, 5093, 5094, 5095, 5096, 5097, 5098, 5099, 5100, 5129, 5130, 5131, 5132, 5133, 5134, 5231, 5232,
         5233, 5287, 5323, 5371, 5372, 5373, 5374, 5375, 5376, 5377, 5378, 5379, 5562, 5663, 5664, 5665, 5856, 5857,
         5858, 5859, 5860, 5861, 5862, 5863, 5864, 5865, 5866, 5867, 5868, 5907, 5913, 5914, 5915, 5916, 5957, 5958,
         5959, 5960, 5961, 5962, 5963, 5993, 5994, 5995, 5996, 5997, 5998, 5999, 6000, 6001, 6002, 6003, 6004, 6005,
         6006, 6007, 6008, 6009, 6010, 6011, 6041, 6042, 6043, 6044, 6045, 6046, 6047, 6048, 6049, 6050, 6051, 6052,
         6053, 6054, 6055, 6056, 6057, 6058, 6059, 6089, 6090, 6091, 6092, 6093, 6094, 6095, 6096, 6097, 6098, 6099,
         6100, 6101, 6102, 6103, 6104, 6105, 6106, 6107, 6137, 6138, 6139, 6140, 6141, 6142, 6143, 6144, 6145, 6146,
         6147, 6148, 6149, 6150, 6151, 6152, 6153, 6154, 6155, 6185, 6186, 6187, 6188, 6189, 6190, 6191, 6192, 6193,
         6194, 6195, 6196, 6197, 6198, 6199, 6200, 6201, 6202, 6203, 6233, 6234, 6235, 6236, 6237, 6238, 6239, 6240,
         6241, 6242, 6243, 6244, 6245, 6246, 6247, 6248, 6249, 6250, 6251, 6281, 6282, 6283, 6284, 6285, 6286, 6287,
         6288, 6289, 6290, 6291, 6292, 6293, 6294, 6295, 6296, 6297, 6298, 6299, 6329, 6330, 6331, 6332, 6333, 6334,
         6335, 6336, 6337, 6338, 6339, 6340, 6341, 6342, 6343, 6344, 6345, 6346, 6347, 6441, 6442, 6443, 6483, 6484,
         6485, 6486, 6487, 6488, 6489, 6490, 6491, 6572, 6573, 6574, 6575, 6576, 6577, 6865, 6866, 6867, 6868, 6869,
         6870, 6871, 6872, 6873, 6874, 6875, 6922, 6923, 6953, 6954, 6955, 6956, 7005, 7195, 7196, 7197, 7198, 7204,
         7205, 7206, 7207, 7208, 7209, 7210, 7211, 7402, 7403, 7439, 7440, 7441, 7442, 7443, 7444, 7445, 7446, 7447,
         7448, 7449, 7450, 7451, 7495, 7496, 7497, 7498, 7499, 7538, 7577, 7578, 7579, 7580, 7581, 7582, 7722, 7739,
         7771, 7772, 7773, 7774, 7775, 7776, 7777, 7778, 7779, 7780, 7781, 7782, 7783, 7784, 7785, 7786, 7787, 7827,
         7828, 7866, 7867, 7924, 7925, 7926, 7963, 7964, 7965, 7966, 7967, 7968, 7969, 7970, 7971, 7972, 7973, 7974,
         7975, 7976, 7977, 7978, 7979, 8011, 8027, 8165, 8166, 8167, 8168, 8169, 8170, 8362, 8363, 8398, 8458, 8459,
         8642, 8689, 8690, 8691, 8692, 8693, 8694, 8695, 8696, 8697, 8698, 8699, 8730, 8731, 8732, 8733, 8734, 8735,
         8736, 8737, 8738, 8739, 8740, 8741, 8742, 8743, 8778, 8779, 8780, 8781, 8782, 8783, 8784, 8785, 8786, 8787,
         8788, 8789, 8790, 8791, 8792, 8793, 8794, 8795, 8828, 8829, 8830, 8831, 8832, 8833, 8834, 8835, 8836, 8837,
         9066, 9067, 9068, 9069, 9070, 9071, 9072, 9073, 9074, 9075, 9076, 9077, 9078, 9079, 9080, 9081, 9082, 9083,
         9114, 9115, 9116, 9117, 9118, 9119, 9120, 9121, 9122, 9123, 9124, 9125, 9126, 9127, 9128, 9129, 9130, 9131,
         9162, 9163, 9164, 9165, 9166, 9167, 9210, 9211, 9212, 9213, 9214, 9215, 9268, 9269, 9270, 9271, 9272, 9273,
         9274, 9275, 9306, 9307, 9308, 9309, 9310, 9311, 9312, 9313, 9314, 9315, 9316, 9317, 9318, 9319, 9320, 9321,
         9322, 9323, 9371, 9402, 9403, 9404, 9405, 9406, 9407, 9408, 9409, 9410, 9411, 9412, 9413, 9414, 9415, 9416,
         9417, 9418, 9553, 9554, 9555, 9600, 9601, 9602, 9603, 9604, 9605, 9606, 9607, 9608, 9609, 9610, 9611, 9743,
         9744, 9745, 9746, 9747, 9748, 9749, 9750, 9751, 9752, 9753, 9754, 9787, 9788, 9789, 9790, 9791, 9792, 9793,
         9794, 9795, 9796, 9797, 9798, 9799, 9800, 9801, 9802, 9803, 10073, 10074, 10075, 10076, 10077, 10078, 10079,
         10080, 10081, 10082, 10083, 10084, 10085, 10086, 10087, 10088, 10089, 10090, 10091, 10220, 10221, 10222, 10223,
         10224, 10225, 10226, 10227, 10228, 10229, 10230, 10231, 10232, 10233, 10234, 10235, 10236, 10315, 10316, 10332,
         10363, 10364, 10378, 10470, 10603, 10604, 10752, 10760, 10798, 10799, 10800, 10801, 10802, 10808, 10809, 10810,
         10811, 10812, 10891, 10897, 10898, 10899, 10900, 10901, 10902, 10903, 10904, 10905, 10906, 10907, 10908, 11082,
         11083, 11084, 11085, 11086, 11087, 11088, 11089, 11090, 11091, 11092, 11135, 11136, 11137, 11138, 11139, 11146,
         11147, 11148, 11187, 11188, 11189, 11190, 11191, 11192, 11193, 11194, 11195, 11196, 11387, 11388, 11417, 11418,
         11419, 11420, 11421, 11422, 11423, 11424, 11425, 11426, 11427, 11428, 11429, 11430, 11431, 11432, 11433, 11434,
         11435, 11436, 11471, 11472, 11473, 11474, 11475, 11476, 11766, 11767, 11768, 11769, 11770, 11771, 11772, 11800,
         11801, 11802, 11803, 11804, 11805, 11806, 11807, 11808, 11809, 11810, 11811, 11812, 11813, 11814, 11815, 11816,
         11817, 11818, 11819, 11820, 11848, 11849, 11850, 11851, 11852, 11853, 11854, 11855, 11856, 11857, 11858, 11859,
         11860, 11866, 11867, 11868, 11869, 11900, 11901, 11902, 11948, 11949, 11950, 11951, 11952, 11953, 11954, 11955,
         11956, 11957, 11958, 11959, 11960, 11961, 11962, 11963, 11964, 12048, 12049, 12050, 12051, 12052, 12053, 12054,
         12055, 12056, 12057, 12058, 12059, 12060, 12061, 12185, 12252, 12253, 12281, 12282, 12283, 12284, 12285, 12286,
         12287, 12288, 12289, 12290, 12291, 12292, 12301, 12328, 12329, 12330, 12331, 12332, 12333, 12334, 12335, 12336,
         12337, 12338, 12339, 12340, 12341, 12342, 12343, 12344, 12345, 12346, 12347, 12377, 12378, 12379, 12380, 12381,
         12395, 12396, 12397, 12486, 12487, 12488, 12489, 12490, 12491, 12492, 12493, 12519, 12520, 12521, 12522, 12523,
         12524, 12525, 12526, 12527, 12528, 12529, 12530, 12531, 12532, 12533, 12534, 12535, 12536, 12537, 12538, 12539,
         12540, 12541, 12569, 12570, 12571, 12572, 12581, 12582, 12583, 12584, 12622, 12623, 12624, 12712, 12718, 12719,
         12720, 12721, 12727, 12728, 12729, 12730, 12731, 12732, 12733, 12771, 12809, 12810, 12811, 12856, 12878, 12903,
         12904, 12905, 12906, 12907, 12908, 12909, 12910, 12911, 12912, 12913, 12922, 12923, 12924, 12925, 12951, 12952,
         12953, 12968, 12969, 12970, 12971, 12972, 12973, 13000, 13001, 13002, 13003, 13004, 13005, 13006, 13007, 13008,
         13009, 13010, 13011, 13012, 13013, 13014, 13015, 13016, 13017, 13018, 13019, 13020, 13021, 13047, 13048, 13049,
         13050, 13051, 13052, 13053, 13054, 13055, 13056, 13057, 13058, 13059, 13060, 13061, 13062, 13063, 13064, 13065,
         13066, 13067, 13068, 13069, 13095, 13096, 13097, 13098, 13099, 13100, 13101, 13102, 13103, 13104, 13105, 13106,
         13107, 13108, 13109, 13110, 13111, 13112, 13113, 13114, 13115, 13116, 13117, 13144, 13145, 13163, 13164, 13165,
         13190, 13191, 13192, 13193, 13194, 13195, 13196, 13238, 13239, 13240, 13241, 13242, 13248, 13249, 13250, 13251,
         13252, 13253, 13254, 13255, 13256, 13257, 13258, 13259, 13260, 13261, 13335, 13336, 13337, 13338, 13339, 13340,
         13341, 13342, 13343, 13344, 13345, 13346, 13347, 13348, 13349, 13350, 13351, 13352, 13353, 13354, 13355, 13356,
         13357, 13384, 13385, 13391, 13392, 13393, 13394, 13395, 13396, 13489, 13490, 13491, 13531, 13575, 13576, 13583,
         13584, 13585, 13586, 13587, 13588, 13594, 13595, 13596, 13597, 13622, 13623, 13624, 13625, 13626, 13627, 13628,
         13629, 13630, 13631, 13675, 13691, 13724, 13730, 13731, 13732, 13733, 13734, 13735, 13736, 13737, 13738, 13739,
         13740, 13741, 13742, 13778, 13779, 13780, 13781, 13782, 13783, 13825, 13880, 13881, 13916, 13917, 13918, 13919,
         13920, 13960, 13961, 13962, 13963, 13964, 13965, 13966, 13967, 13968, 13969, 13970, 13971, 13972, 13973, 13974,
         13975, 13976, 13977, 13978, 13979, 13980, 13981, 13982, 14006, 14007, 14008, 14009, 14010, 14026, 14027, 14028,
         14029, 14030, 14198, 14199, 14200, 14201, 14202, 14203, 14204, 14205, 14206, 14207, 14220, 14293, 14294, 14295,
         14296, 14297, 14298, 14299, 14300, 14301, 14302, 14303, 14304, 14305, 14306, 14307, 14308, 14309, 14310, 14311,
         14312, 14313, 14314, 14315, 14341, 14342, 14343, 14344, 14345, 14346, 14347, 14390, 14391, 14392, 14393, 14394,
         14395, 14396, 14397, 14398, 14399, 14400, 14401, 14402, 14403, 14404, 14405, 14406, 14414, 14441, 14442, 14450,
         14451, 14452, 14453, 14454, 14455, 14456, 14457, 14458, 14459, 14460, 14461, 14462, 14485, 14491, 14492, 14493,
         14494, 14495, 14496, 14497, 14543, 14544, 14545, 14546, 14547, 14548, 14549, 14550, 14551, 14552, 14553, 14554,
         14555, 14556, 14557, 14558, 14584, 14585, 14586, 14587, 14588, 14589, 14590, 14591, 14592, 14593, 14594, 14595,
         14596, 14597, 14598, 14599, 14600, 14601, 14602, 14603, 14604, 14630, 14631, 14632, 14633, 14634, 14635, 14636,
         14637, 14638, 14639, 14640, 14641, 14642, 14678, 14679, 14680, 14681, 14682, 14683, 14684, 14685, 14700, 14701,
         14702, 14778, 14779, 14780, 14781, 14782, 14783, 14784, 14785, 14786, 14787, 14788, 14789, 14790, 14791, 14792,
         14793, 14794, 14795, 14796, 14797, 14798, 14822, 14823, 14824, 14825, 14826, 14827, 14828, 14829, 14830, 14831,
         14832, 14833, 14834, 14835, 14836, 14837, 14838, 14844, 14845, 14846, 14871, 14872, 14873, 14874, 14875, 14876,
         14877, 14878, 14879, 14880, 14881, 14882, 14883, 14884, 14885, 14886, 14887, 14888, 14889, 14890, 14891, 14927,
         14928, 14929, 14930, 14931, 14932, 14933, 14934, 14935, 14936, 14937, 14938, 14939, 14940, 14941, 14942, 14943,
         14969, 14970, 15119, 15120, 15130, 15131, 15132, 15133, 15134, 15135, 15158, 15159, 15160, 15161, 15162, 15163,
         15214, 15215, 15216, 15217, 15218, 15219, 15220, 15221, 15222, 15223, 15224, 15225, 15226, 15227, 15253, 15254,
         15255, 15256, 15257, 15258, 15259, 15260, 15261, 15262, 15263, 15264, 15265, 15266, 15267, 15268, 15269, 15270,
         15271, 15272, 15273, 15274, 15275, 15276, 15277, 15278, 15279, 15302, 15303, 15304, 15305, 15306, 15307, 15308,
         15309, 15310, 15311, 15312, 15313, 15421, 15422, 15423, 15493, 15494, 15495, 15496, 15497, 15498, 15499, 15500,
         15501, 15502, 15503, 15504, 15505, 15506, 15507, 15508, 15509, 15510, 15511, 15512, 15513, 15514, 15515, 15516,
         15517, 15518, 15519, 15541, 15542, 15543, 15544, 15550, 15564, 15565, 15566, 15567, 15589, 15590, 15591, 15592,
         15593, 15594, 15595, 15601, 15602, 15603, 15614, 15734, 15735, 15736, 15737, 15939, 15940, 15941, 15942, 15943,
         15944, 15945, 15946, 15947, 15948, 15949, 15976, 15977, 15978, 15979, 15980, 15981, 15982, 15983, 15997, 15998,
         15999, 16022, 16023, 16024, 16025, 16026, 16027, 16028, 16029, 16030, 16031, 16032, 16033, 16034, 16035, 16036,
         16037, 16038, 16039, 16040, 16041, 16042, 16043, 16044, 16045, 16046, 16047, 16125, 16126, 16127, 16128, 16314,
         16363, 16364, 16365, 16366, 16409, 16410, 16411, 16412, 16413, 16414, 16415, 16416, 16417, 16418, 16419, 16420,
         16421, 16422, 16423, 16424, 16425, 16426, 16427, 16428, 16429, 16430, 16431, 16453, 16454, 16455, 16456, 16457,
         16458, 16459, 16460, 16461, 16462, 16463, 16464, 16465, 16466, 16467, 16468, 16469, 16470, 16471, 16472, 16473,
         16474, 16475, 16476, 16477, 16478, 16479, 16480, 16501, 16502, 16549, 16550, 16551, 16552, 16553, 16554, 16555,
         16556, 16557, 16558, 16559, 16560, 16561, 16562, 16563, 16569, 16570, 16571, 16572, 16573, 16574, 16575, 16576,
         16614, 16615, 16616, 16617, 16618, 16619, 16620, 16621, 16622, 16623, 16624, 16700, 16701, 16809, 16855, 16856,
         16857, 16858, 16859, 16860, 16861, 16862, 16863, 16864, 16885, 16886, 16887, 16888, 16889, 16890, 16891, 16892,
         16893, 16894, 16895, 16896, 16897, 16898, 16899, 16905, 16906, 16907, 16908, 16909, 16989, 16990, 17130, 17131,
         17132, 17133, 17134, 17135, 17136, 17137, 17138, 17139, 17140, 17141, 17142, 17143, 17144, 17145, 17146, 17147,
         17148, 17149, 17150, 17151, 17152, 17174, 17175, 17176, 17177, 17178, 17224, 17225, 17226, 17227, 17228, 17229,
         17230, 17231, 17232, 17233, 17234, 17235, 17236, 17237, 17238, 17239, 17240, 17241, 17247, 17248, 17270, 17271,
         17272, 17273, 17274, 17275, 17276, 17277, 17278, 17279, 17280, 17281, 17282, 17283, 17284, 17285, 17286, 17287,
         17288, 17289, 17290, 17291, 17292, 17340, 17341, 17342, 17343, 17344, 17431, 17432, 17433, 17434, 17435, 17436,
         17437, 17438, 17439, 17440]



    print(len(day))
    print(len(night))
    day = pd.DataFrame([1,3,4,5], index=[2,3,5,7])
    print(day)
    a = day.set_index([list(range(len(day)))])
    print(a)
    print(day)

    print(calculate_mean(a, 0, 3, 0))